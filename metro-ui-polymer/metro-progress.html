<link rel="import" href="../polymer/polymer.html">

<dom-module id="metro-progress">
  <!--
  `<metro-progress>` inserts a simple Metro UI styled progress bar into a page.

  ### Styling

  `<metro-progress>` provides the following custom properties for styling:

  Custom property | Description | Default
  ----------------|-------------|--------
  `--metro-progress-bar-background` | Background for the unfilled portion of the progress bar | `#eeeeee`
  `--metro-progress-bar-color` | Background for the filled portion of the progress bar | `#1ba1e1`
  `--metro-progress-bar-height` | Height of the progress bar | `0.625rem`

  @demo demo/index.html Demos of the metro-progress element
  -->
  <template strip-whitespace>
    <style>
      :host {
        display: block;
        position: relative;
        width: 100%;
        height: auto;
        margin: 0.625rem 0;
        background: var(--metro-progress-bar-background, #eeeeee);
        overflow: hidden;
      }
      :host:before, :host:after {
        display: table;
        content: "";
      }
      :host:after {
        clear: both;
      }

      #bar {
        position: relative;
        display: block;
        float: left;
        width: var(--metro-progress-bar-width, 0);
        background: var(--metro-progress-bar-color, #1ba1e2);
        z-index: 1;
        text-align: center;
        height: var(--metro-progress-bar-height, 0.625rem);
        line-height: 0.625rem;
        color: #ffffff;
      }
    </style>
    <div id="bar"></div>
  </template>

  <script>
    window.MetroUI = window.MetroUI || {};

    window.MetroUI.MetroProgressElement = Polymer({
      is: 'metro-progress',

      properties: {
        /**
         * The percentage of the progress bar to be filled
         */
        value: {
          type: Number,
          value: 0,
          observer: "_valueChanged"
        },
      },

      /**
       * Updates the displayed width of the filled portion of the progress bar
       * when the `value` changes
       *
       * @param newValue This progress bar's new percentage filled value
       * @param oldValue This progress bar's previous percentage filled value
       * @private
       */
      _valueChanged: function(newValue, oldValue) {
        if (newValue < 0) {
          this.customStyle['--metro-progress-bar-width'] = '0';
        } else if (newValue > 100) {
          this.customStyle['--metro-progress-bar-width'] = '100%';
        } else {
          this.customStyle['--metro-progress-bar-width'] = newValue + '%';
        }
        this.updateStyles();
      }

    });
  </script>
</dom-module>
